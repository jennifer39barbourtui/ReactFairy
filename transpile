#!/usr/bin/env node

const { transpile } = require('.')
const minimist = require('minimist')

const { input, output, prefetch } = minimist(process.argv.slice(2), {
  string: ['input', 'output'],
  boolean: ['prefetch'],
  alias: {
    in: 'input',
    out: 'output',
  },
  default: {
    input: process.cwd(),
    output: `${process.cwd()}/out`,
    prefetch: true,
  }
});

transpile(input, output, { prefetch }).then(() => {
  console.log()
  console.log(`Transpilation to ${output} has been complete`)
  console.log()
})
.catch((e) => {
  console.log()
  console.log('Transpilation has failed. Error:')
  console.log()
  console.log(e.stack)
  console.log()
})
